This respository contains an example CLIJ2 plugin which internally utilizes ImageJ (on the CPU) for processing a result. 
An ImageJ macro also shows how to call such a custom plugin.